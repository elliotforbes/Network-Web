<html>
    <head>
        <title>Network Monitoring | Elliot Forbes</title>
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="assets/js/c3.css">
        <script src="assets/js/d3.min.js"></script>
        <script src="assets/js/c3.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
        <link rel="stylesheet" href="style.css">
    </head>
    <body ng-app="">
        <div class="topnav">
            <ul class="nav">
                <li>Network Monitoring</li>
            </ul>
        </div>
        
        <div class="content">
            <div class="row">
               <div class="col-md-12">
                   <div class="status-bar">Script Status: <span class="green">Online</span></div>
               </div>
                <div ng-controller="raspberryController" class="col-md-6">
                    <div class="content-box">
                        <h2>Pis on the Network</h2>
                        <div>
                            <div data-chart data-value="value"></div>
                        </div>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <td>#</td>
                                    <td>IP Address</td>
                                    <td>Connected</td>
                                    <td>Lease Time</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="x in names">
                                    <td>{{ x.ID }}</td>
                                    <td>{{ x.IP }}</td>
                                    <td>{{ x.CONNECTED }}</td>
                                    <td>{{ x.LEASE_TIME }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="content-box">
                        <h2>Throughput Test Results</h2>
                        <br/>
                        <div id="chart2"></div>
                    </div>
                    
                    <div class="content-box">
                        <h2>Download/Upload Test Results</h2>
                        <br/>
                        <div id="chart3"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="content-box">
                       <h2>Network Traffic Percentages</h2>
                       <br/>
                        <div id="chart"></div>
                    </div>
                    <div class="content-box">
                        <h2>About:</h2>
                        <br/>
                        <p>This was developed as part of a 4th Year Computer Science project which looks to test distinct elements of a network and report back to a user in real-time. 
                        This Project was built using a combination of the following:
                        <ul>
                            <li>Angular.js</li>
                            <li>C3.js + D3.js</li>
                            <li>Python</li>
                        </ul>
                        </p>
                    </div>
                    <div class="content-box">
                        <h2>Links:</h2>
                        <br/>
                        If you wish to view the source code for this project then check out the following links:
                        <br/>
                        <ul>
                            <li><a href="https://github.com/emforce/Network-Web">Network-Web</a> : The front-end web based GUI.</li>
                            <li><a href="https://github.com/emforce/Personal">Network Monitor</a> : The Backend python script that drives the engine.</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
        <script>

            function raspberryController($scope, $http, $timeout) {
                var poll = function() {
                    $timeout(function() {
                        try{
                                $http.get("dbConn.php")
                                .success(function(response) {$scope.names = response;})
                                .error(function(data, status, header, config) {
                                    alert(status);
                                });
                            } catch (e) {
                              console.log("Got an error!",e);
                              throw e; // rethrow to not marked as handled
                          }
                        poll();
                    }, 1000);
                }
                poll();
            }
            
        </script>
        <script src="chart.js"></script>
    </body>
</html>